---
title: "Lab 09v2 - Grading the professor, Pt. 1"
author: "John Bennett"
date: "March 22, 2022"
output: github_document
---

### Load packages and data

```{r load-packages, message=FALSE}
library(tidyverse) 
library(broom)
library(openintro)
```

```{r ?evals}
?evals
```

### Part 1

```{r Viz1}
ggplot(evals, aes(x = score)) + geom_density()
```

Q1. Visualize the distribution of score. Is the distribution skewed? What does that tell you about how students rate courses? Is this what you expected to see? Why, or why not? Include any summary statistics and visualizations you use in your response.
A. The distribution is negatively skewed. This tells me that students rate the majority of their courses with very high scores. I was expecting to see a normal distribution because there would be a vast diversity of opinions when it comes to course evals. However, the positive evals do make sense when considering that many of the courses will be electives, leading to a natural tendency for students to at least favor the material covered in the courses. This could possibly boost impressions of individual professors. 

Q2. Visualize and describe the relationship between score and the variable bty_avg, a professor’s average beauty rating.
    Hint: See the help page for the function at http://ggplot2.tidyverse.org/reference/index.html.

```{r Viz2}
p <- ggplot(evals, aes(score, bty_avg))
p + geom_point()
```

Q3. Replot the scatterplot from Exercise 3, but this time use geom_jitter()? What does “jitter” mean? What was misleading about the initial scatterplot?
A. Jittering adds a small amount of variation to the data points, so that they do not visually plot on top of each other. When that happens, two data points would appear as one. So that we can see our data points, jitter spaces the points out slightly. 

```{r Viz3}
p <- ggplot(evals, aes(score, bty_avg))
p + geom_jitter()
```

-Testing a different way of fine-tuning the visualization. 
```{r Viz4}
p <- ggplot(evals, aes(score, bty_avg))
p + geom_jitter(aes(colour = gender))
```


### Part 2

Q4. Let’s see if the apparent trend in the plot is something more than natural variation. Fit a linear model called m_bty to predict average professor evaluation score by average beauty rating (bty_avg). Based on the regression output, write the linear model.
A. The code and results of the linear model are below.

```{r Linearmodel1}
m_bty.lm <- lm(score ~ bty_avg, data = evals)
summary(m_bty.lm)
```

Thus, our linear model (y=b0+b1x) will be y = 3.88 + .066 

Q5. Replot your visualization from Exercise 3, and add the regression line to this plot in orange color. Turn off the shading for the uncertainty of the line.
A. Code for regression line added to visualization. 

```{r Viz5}
ggplot(evals, aes(score, bty_avg)) + 
geom_jitter() 
stat_smooth(method = lm) 
reg1 <- lm(score~bty_avg,data=evals) 
	summary(reg1)
with(evals,plot(score, bty_avg))
	abline(reg1)
```

Q6. Interpret the slope of the linear model in context of the data.
A. The slope (.066) is an effect size representing the degree to which eval scores are associated with (i.e., can predict) average beauty rating. 

Q7. Interpret the intercept of the linear model in context of the data. Comment on whether or not the intercept makes sense in this context.
A. The intercept (3.88) is the predicted eval score for an individual with a “0” on average beauty rating.
On initial impression, this intercept does not make sense to me, in this context. An individual with a "0" on beauty rating does not seem to have a place in the visual plot. After looking at the plot further, it makes sense that a person with a "0" on beauty rating would have an eval score in the middle of the plot. If there is a weak relationship between our variables, then the predictor variable simply predicts "something in the middle". 

Q8. Determine the R2 of the model and interpret it in context of the data.
A. In the context of this data, and probably most data, an R2 of .033 can be considered very low. Here, (.033) or 3 percent is the proportion of variance in eval scores that is accounted for by beauty rating. The R2 (.033) is an effect size representing the degree to which individuals’ beauty ratings are associated with (i.e., can predict) their eval scores.

### Part 3

Q9. Fit a new linear model called m_gen to predict average professor evaluation score based on gender of the professor. Based on the regression output, write the linear model and interpret the slope and intercept in context of the data.
A. Our linear model (y=b0+b1x) will be y = 4.1 + .14
-The slope (.14) is an effect size representing the degree to which gender is associated with (i.e., can predict) eval score. 
-The intercept (4.1) is the predicted eval score for an individual with a “0” on gender.


```{r VizPart3}
p <- ggplot(evals, aes(score, gender))
p + geom_point()
```

```{r Linearmodel2}
mgen.lm <- lm(score ~ gender, data = evals)
summary(mgen.lm)
```



Q10.1. What is the equation of the line corresponding to male professors? 
Our linear model will be y = 3.7 + .11


```{r Filtermale}
male_data <- evals %>%
filter(gender == "male")
```

```{r MaleData}
p <- ggplot(male_data, aes(score, bty_avg))
p + geom_point()
```
```{r MaleLinearmodel}
male.lm <- lm(score ~ bty_avg, data = male_data)
summary(male.lm)
```

Q10.2. What is the equation of the line corresponding to female professors?
Our linear model will be y = 3.95 + .03


```{r Filterfemale}
female_data <- evals %>%
filter(gender == "female")
```

```{r FemaleData}
p <- ggplot(female_data, aes(score, bty_avg))
p + geom_point()
```

```{r FemaleLinearmodel}
female.lm <- lm(score ~ bty_avg, data = female_data)
summary(female.lm)
```


Q11. Fit a new linear model called m_rank to predict average professor evaluation score based on rank of the professor. Based on the regression output, write the linear model and interpret the slopes and intercept in context of the data.
A. Our linear model for tenure track is y = 4.3 - .13
-The slope (-.13) is an effect size representing the degree to which tenure track status is associated with (i.e., can predict) eval score. 
-The intercept (4.3) is the predicted eval score for an individual with a “0” on tenure track. 

```{r RankLinearmodel}
m_rank.lm <- lm(score ~ rank, data = evals)
summary(m_rank.lm)
```


Q12. Create a new variable called rank_relevel where "tenure track" is the baseline level.

```{r NewVarTenureTrack}
rank_relevel <- evals %>%
filter(rank == "tenure track")
```


Q13. Fit a new linear model called m_rank_relevel to predict average professor evaluation score based on rank_relevel of the professor. This is the new (releveled) variable you created in Exercise 13. Based on the regression output, write the linear model and interpret the slopes and intercept in context of the data. Also determine and interpret the R2 of the model.

Q14. Create another new variable called tenure_eligible that labels "teaching" faculty as "no" and labels "tenure track" and "tenured" faculty as "yes".

Q15. Fit a new linear model called m_tenure_eligible to predict average professor evaluation score based on tenure_eligibleness of the professor. This is the new (regrouped) variable you created in Exercise 15. Based on the regression output, write the linear model and interpret the slopes and intercept in context of the data. Also determine and interpret the R2
of the model.


